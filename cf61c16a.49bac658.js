(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{70:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(75),s=a(77),c=a(79),i=a(3),m=a(71),u=a(73),h=a.n(u),p=a(80),d=a(81),y=a(92),l=a(87),C=a(88),g=a(93),f=a(90),w=a(83),v=a(82),b=a(91),E=function(e){function t(t){var a;a=e.call(this,t)||this;var n=t.match.params.id,o=a.getCountryData(t.match.params.id);a.platformRepo=new v.a(d),a.gatewayRepo=new w.a(d);var r=a.getGateways(n),s=a.getRecommended(r);return a.state={country:o,gateways:r,compare:s},a.onChangeCountry=a.onChangeCountry.bind(Object(c.a)(a)),a.onChangeGateway=a.onChangeGateway.bind(Object(c.a)(a)),a.addToCompare=a.addToCompare.bind(Object(c.a)(a)),a.clearAndAddToCompare=a.clearAndAddToCompare.bind(Object(c.a)(a)),a.removeFromCompare=a.removeFromCompare.bind(Object(c.a)(a)),a}Object(i.a)(t,e);var a=t.prototype;return a.getCountryData=function(e){return h.a.find(p,{code:h.a.upperCase(e)})},a.componentDidMount=function(){var e=this;this.state.country||this.getCountryByIp().catch((function(){return"US"})).then((function(t){t&&e.props.history.push("/country/"+t.toLowerCase())}))},a.componentDidUpdate=function(e,t,a){var n=this,o=this.props.match.params.id;if(h.a.get(e,"match.params.id")!==o){var r=this.getCountryData(o);r||this.getCountryByIp().catch((function(){return"US"})).then((function(e){e&&n.props.history.push("/country/"+e.toLowerCase())}));var s=this.getGateways(o),c=this.getRecommended(s);this.setState({gateways:s,compare:c,country:r})}},a.getCountryByIp=function(){return b.a.countryCode()},a.onChangeCountry=function(e){this.props.match.params.id!==e.value&&this.props.history.push("/country/"+(e.value||"").toLowerCase())},a.getGateways=function(e){return void 0===e&&(e=null),this.gatewayRepo.query().whereIncludes("countries",e?(e||"").toUpperCase():null).get()},a.getGatewaysCountries=function(){var e=new Set,t=this.getGateways();return t&&t.forEach((function(t){(t.countries||[]).forEach((function(t){e.add(t)}))})),e},a.getOrdered=function(e){return h.a.orderBy(e,["recommended","name"],["asc","asc"])},a.addToCompare=function(e){var t=[].concat(this.state.compare);t.push(e),this.setState({compare:t})},a.clearAndAddToCompare=function(e){var t=[];t.push(e),this.setState({compare:t})},a.removeFromCompare=function(e){var t=[].concat(this.state.compare);t=h.a.filter(t,(function(t){return t.id!==e.id})),this.setState({compare:t})},a.onChangeGateway=function(e){var t=h.a.find(this.state.gateways,{id:e.value});this.clearAndAddToCompare(t)},a.getECommerces=function(){return this.platformRepo.query().where("type","=","ECOMMERCE").get()},a.getRecommended=function(e){return h.a.filter(e,{recommended:!0})},a.render=function(){return this.state.country?o.a.createElement(r.a,{title:(this.state.country||{name:"Shuttle"}).name+" | What payment gateway should I use?"},o.a.createElement("div",{className:"container"})," ",o.a.createElement("div",{className:Object(m.a)("container","my-5")},o.a.createElement(f.a,{img:this.state.country.flag_base64,name:this.state.country.name,className:"bordered"}),o.a.createElement(l.a,{countries:this.getGatewaysCountries(),className:"mb-5",onChange:this.onChangeCountry,value:h.a.upperCase(this.state.country.code)}),o.a.createElement("hr",null),o.a.createElement(g.a,{title:"The following payment processors support "+this.state.country.name,gateways:this.getOrdered(this.state.gateways),selected:this.state.compare,onShow:this.clearAndAddToCompare,onAddToCompare:this.addToCompare,onRemoveFromCompare:this.removeFromCompare}),o.a.createElement(C.a,{gateways:this.state.gateways,recommendedFirst:!0,value:h.a.get(this,"state.compare[0]"),onChange:this.onChangeGateway,className:"mb-5"})),o.a.createElement("div",{className:"container-fluid mb-5"},o.a.createElement(y.a,{platform:this.platform,gateways:this.state.compare,country:this.state.country.code,ecommerces:this.getECommerces(),className:"mx-auto"}))):null},t}(o.a.Component);t.default=function(){var e=Object(s.useRouteMatch)();return o.a.createElement(s.Switch,null,o.a.createElement(s.Route,{path:e.path+"/:id?",component:E}))}}}]);